#!/usr/bin/env ruby
$:.unshift(File.dirname(__FILE__) + "/../lib")
require "poolparty"

require 'git-style-binary/command'

GitStyleBinary.command do  
  version "PoolParty #{$0} command"  
  banner <<-EOS
Usage: #{$0} #{all_options_string} COMMAND [ARGS]

  puts a helpful ssh config
EOS

  short_desc "puts a helpful ssh config"

  run do |command|    
    @loaded_clouds.each do |cld|
      
        if cld.nodes(:status => "running").empty?
          puts "Your cloud is not running"
        else
          str =<<-EOE
          Host #{cld.name}
            User        #{cld.user}
            Hostname    #{cld.nodes(:status => "running").first.ip}
            IdentityFile    #{cld.keypair}
          EOE
        
          puts "Enter the following in your .ssh/config file"
          puts str
        end
      
    end    
  end
end